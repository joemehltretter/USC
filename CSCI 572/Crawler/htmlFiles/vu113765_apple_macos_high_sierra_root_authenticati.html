<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>Vulnerability Note VU#113765 - Apple MacOS High Sierra disabled account authentication bypass</title><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="/vulfeed" rel="alternate" title="Recently Published Vulnerability Notes" type="application/atom+xml">
<meta content="Thu, 30 Nov 2017 02:43:45 GMT" name="date"/>
<meta content="Apple MacOS High Sierra fails to properly require authentication for disabled accounts, such as root account, which can allow an authenticated user to obtain root privileges." name="description"/>
<meta name="keywords" value="#iamroot"/>
<link href="/vuls/css/global.css" rel="stylesheet" type="text/css"/>
<link href="/vuls/css/vulnotes.css" rel="stylesheet" type="text/css"/>
<link href="/vuls/css/vulnotes-print.css" media="print" rel="stylesheet" type="text/css"/>
<script src="/vuls/javascripts/jquery-min.js" type="text/javascript"></script>
<script src="/vuls/javascripts/global.js" type="text/javascript"></script>
<script src="/vuls/javascripts/vulnotes.js" type="text/javascript"></script>
<link href="/favicon-uscert.ico" rel="shortcut icon" type="image/x-icon"/></link></head>
<body bgcolor="#FFFFFF" text="#000000">
<script language="JavaScript" type="text/javascript">
<!-- 
$(function(){
			$("#vendor-info2 tr:even").addClass("row-alt");
});
// -->
</script>
<div id="header-wrapper">
<div id="header">
<div id="logo">
<div id="cert"><a href="http://www.cert.org/">CERT</a></div>
<div id="sei"><a href="http://www.sei.cmu.edu/">Software Engineering Institute</a></div>
<div id="cmu"><a href="http://www.cmu.edu/">Carnegie Mellon University</a></div>
<div id="vulnotesdb"><a href="/vuls/">Vulnerability Notes Database</a></div>
</div>
<div id="sponsored-by">
<a href="http://www.dhs.gov/office-cybersecurity-and-communications">Sponsored by the Department of Homeland Security (DHS)</a>
</div>
</div>
</div>
<div id="navigation-wrapper">
<div id="navigation">
<ul>
<li><a href="/vuls/"><span>Database Home</span></a></li>
<li class="selected"><a href="/vuls/html/search/"><span>Search</span></a></li>
<li><a href="https://vulcoord.cert.org/VulReport/"><span>Report a Vulnerability</span></a></li>
<li class="last"><a href="/vuls/html/help/"><span>Help</span></a></li>
</ul>
</div>
</div>
<!-- MAIN BODY START -->
<div id="main-content">
<div class="left-content vul-note" id="content-container">
<h1>Vulnerability Note VU#113765</h1>
<h2>Apple MacOS High Sierra disabled account authentication bypass</h2>
<p class="meta-text">Original Release date: 29 Nov 2017 | Last revised: 29 Nov 2017</p>
<!-- START SOCIAL BUTTONS -->
<div id="social-options">
<!-- START PRINT BUTTON -->
<div id="custom-print-button">
<span id="print-button">
<a href="javascript:window.print();" rel="nofollow">Print Document</a>
</span>
</div>
<!-- END PRINT BUTTON -->
<!-- START TWEET BUTTON -->
<div id="custom-tweet-button">
<span id="tweet-button">
<a class="popup-twitter" href="https://twitter.com/share?url=http%3A%2F%2Fwww.kb.cert.org%2Fvuls%2Fid%2F113765" rel="nofollow" target="_blank">Tweet</a>
</span>
</div>
<script type="text/javascript"> 
	$('.popup-twitter').popupWindow({ 
	height:400, 
	width:575, 
	top:50, 
	left:50 
	}); 
</script>
<!-- END TWEET BUTTON -->
<!-- START FACEBOOK BUTTON -->
<div id="custom-facebook-button">
<span id="facebook-button">
<a class="popup-facebook" href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Fwww.kb.cert.org%2Fvuls%2Fid%2F113765" rel="nofollow" target="_blank">Like Me</a>
</span>
</div>
<script type="text/javascript">
	$('.popup-facebook').popupWindow({ 
	height:500,
	width:900,
	top:50, 
	left:50 
	}); 
</script>
<!-- END FACEBOOK BUTTON -->
<!-- START SHARE BUTTON -->
<div id="custom-share-button">
<span id="share-button">
<a class="popup-share" href="http://www.addthis.com/bookmark.php?url=http%3A%2F%2Fwww.kb.cert.org%2Fvuls%2Fid%2F113765" rel="nofollow" target="_blank">Share</a>
</span>
</div>
<script type="text/javascript"> 
	$('.popup-share').popupWindow({ 
	height:500, 
	width:900, 
	top:50, 
	left:50 
	}); 
</script>
<!-- END SHARE BUTTON --></div><!-- END SOCIAL BUTTONS -->
<div id="vulnerability-note-content">
<a name="overview"></a>
<h3>Overview</h3>
<p>Apple MacOS High Sierra fails to properly require authentication for disabled accounts, such as root account, which can allow an authenticated user to obtain root privileges.</p>
<a name="description"></a>
<h3>Description</h3>
<table border="0" cellpadding="0" cellspacing="0" class="wrapper-table"><tr><td><p>Apple MacOS High Sierra (10.13) contains a flaw in how it authenticates disabled accounts. When a privileged action prompts the user for administrative credentials, the user can simply enter the user of "root" with an empty password. The first attempt appears to fail, but in actuality, this action causes MacOS High Sierra to enable the ability to log in as root using the credentials specified. A second attempt to authenticate using the same credentials successfully takes the action with root administrative privileges. Once this vulnerability has been triggered by an authenticated user (either locally, or via remote access such as SSH), the root account will be available to use as a viable authentication mechanism to the system.
<p>It is important to note that simply confirming the vulnerability on a system will have the side effect of enabling the root account for use in authenticating to the system.</p></p></td></tr></table>
<a name="impact"></a>
<h3>Impact</h3>
<table border="0" cellpadding="0" cellspacing="0" class="wrapper-table"><tr><td><p>A local or remote user of a MacOS High Sierra system can obtain root privileges without requiring credentials. Any system that has the root account enabled (e.g. via testing for this vulnerability) may also expose the root account for use with remote administrative capabilities, such as the built-in "Screen Sharing" or "Remote Management" capabilities</p></td></tr></table>
<a name="solution"></a>
<h3>Solution</h3>
<table border="0" cellpadding="0" cellspacing="0" class="wrapper-table"><tr><td><p><b>Apply an update</b><br>
<br>
This issue is addressed in <a href="https://support.apple.com/en-us/HT208315">Security Update 2017-001</a>.  Please also consider the following workaround if you are unable to install the update:</br></br></p></td></tr></table>
<table border="0" cellpadding="0" cellspacing="0" class="wrapper-table" style="padding-top: 15px;"><tr><td><p><b>Set the root password</b><br>
<ol type="1">
<li>As a user with administrative privileges, launch Terminal
<li>Type <tt>sudo passwd -u root</tt>
<li>Enter a strong password</li></li></li></ol>
<br>
For an alternative GUI method to setting the root password, please see Apple support article <a href="https://support.apple.com/en-us/HT204012">HT204012</a>. <br>
<br>
<b>Note: </b>It is important to <b>not</b> disable the root account after setting a password. If the root account is disabled after setting a password, this action will revert the system back to the vulnerable state.</br></br></br></br></p></td></tr></table>
<a name="vendors"></a><a name="systems"></a>
<h3>Vendor Information <span class="learn-more">(<a href="/vuls/html/fieldhelp#vendorinfo">Learn More</a>)</span></h3>
<table id="vendor-info2" style="margin: 10px 0 20px 0;"><tr><th style="width: 250px; text-align: left; background-color: #EBEBEB; border: 1px solid #d5d7da;border-right: none; padding: 5px 10px; margin:0;">Vendor</th><th style="width: 110px; text-align: center;padding: 5px 10px; background-color: #EBEBEB; border-top: 1px solid #d5d7da; border-bottom: 1px solid #d5d7da; margin:0;">Status</th><th style="width: 125px; text-align: center;padding: 5px 10px; background-color: #EBEBEB; border-top: 1px solid #d5d7da; border-bottom: 1px solid #d5d7da; margin:0;">Date Notified</th><th style="width: 125px; text-align: center;padding: 5px 10px; background-color: #EBEBEB; border: 1px solid #d5d7da; border-left: none;margin:0;">Date Updated</th></tr><tr><td class="vendor" style="width: 250px; text-align: left;padding: 5px 10px; margin:0;">Apple</td><td class="status" style="width: 110px; text-align: center;padding: 5px 10px; margin:0;"><a href="/vuls/id/WDON-ATKJ2T" title="View Vendor Information">Affected</a></td><td class="notified" style="width: 125px; text-align: center;padding: 5px 10px; margin:0;">29 Nov 2017</td><td class="updated" style="width: 125px; text-align: center;padding: 5px 10px; margin:0;">29 Nov 2017</td></tr></table><span class="my-product-affected">If you are a vendor and your product is affected, <a href="mailto:cert@cert.org?Subject=VU%23113765 Vendor Status Inquiry">let
us know</a>.</span>
<a name="cvss"></a>
<h3 style="clear: both !important;">CVSS Metrics <span class="learn-more">(<a href="/vuls/html/fieldhelp#cvss">Learn More</a>)</span></h3>
<table id="cvss-score" style="margin: 10px 0 10px 0;">
<tr>
<th style="width: 100px; text-align: left; background-color: #EBEBEB; border: 1px solid #d5d7da; border-right: none; padding: 5px 10px; margin:0;">Group</th>
<th style="width: 100px; text-align: center;padding: 5px 10px; background-color: #EBEBEB; border-top: 1px solid #d5d7da; border-bottom: 1px solid #d5d7da; margin:0;">Score</th>
<th style="width: 470px; text-align: left; background-color: #EBEBEB; border: 1px solid #d5d7da; border-left: none; padding: 5px 10px; margin:0;">Vector</th>
</tr>
<tr>
<td class="cvss-metric-group" style="width: 100px; text-align: left; padding: 5px 10px; margin:0;">Base</td>
<td class="cvss-score" style="width: 100px; text-align: center; padding: 5px 10px;">7.2</td>
<td class="cvss-vector" style="width: 470px; text-align: left; padding: 5px 10px; margin:0;">AV:L/AC:L/Au:N/C:C/I:C/A:C</td>
</tr>
<tr>
<td class="cvss-metric-group" style="width: 100px; text-align: left; padding: 5px 10px; margin:0;">Temporal</td>
<td class="cvss-score" style="width: 100px; padding: 5px 10px; text-align: center">6.2</td>
<td class="cvss-vector" style="width: 470px; text-align: left; padding: 5px 10px; margin:0;">E:POC/RL:W/RC:C</td>
</tr>
<tr>
<td class="cvss-metric-group" style="width: 100px; text-align: left; padding: 5px 10px; margin:0;">Environmental</td>
<td class="cvss-score" style="width: 100px; padding: 5px 10px; text-align: center">4.6</td>
<td class="cvss-vector" style="width: 470px; text-align: left; padding: 5px 10px; margin:0;">CDP:ND/TD:M/CR:ND/IR:ND/AR:ND</td>
</tr>
</table>
<a name="references"></a>
<h3>References</h3>
<ul>
<li><a href="https://forums.developer.apple.com/thread/79235#277225">https://forums.developer.apple.com/thread/79235#277225</a></li>
<li><a href="https://support.apple.com/en-us/HT204012">https://support.apple.com/en-us/HT204012</a></li>
<li><a href="https://objective-see.com/blog/blog_0x24.html">https://objective-see.com/blog/blog_0x24.html</a></li>
</ul>
<a name="credit"></a>
<h3>Credit</h3>
<p>This vulnerability was publicly disclosed by chethan177.</p>
<p>This document was written by Will Dormann.</p>
<a name="other"></a>
<h3>Other Information</h3>
<ul id="other-info">
<li>
<span class="field-title">CVE IDs:</span>
<span><a href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-13872">CVE-2017-13872</a></span>
</li>
<li>
<span class="field-title">Date Public:</span>
<span>13 Nov 2017</span>
</li>
<li>
<span class="field-title">Date First Published:</span>
<span>29 Nov 2017</span>
</li>
<li>
<span class="field-title">Date Last Updated:</span>
<span>29 Nov 2017</span>
</li>
<li>
<span class="field-title">Document Revision:</span>
<span>41</span>
</li>
</ul>
<div id="provide-feedback">
<h3>Feedback</h3><p>If you have feedback, comments, or additional information about this vulnerability, please send us <a href="mailto:cert@cert.org?Subject=VU%23113765 Feedback">email</a>.</p>
</div>
</div>
</div>
<div class="right-sidebar" id="sidebar-navigation">
<!-- QUICK SEARCHES START -->
<div class="side-panel" id="quick-searches">
<h2>Quick Search</h2>
<ul>
<li>
<form action="/vuls/byid?searchview" method="post" name="vul-search">
<input class="input-field" id="vul-search-general" name="query" type="text" value=""/>
<input class="go" name="go" type="submit" value="Go"/>
</form>
</li>
</ul>
<div class="more-content"><a href="/vuls/html/search/">Advanced Search »</a></div>
</div>
<!-- QUICK SEARCHES END -->
<!-- VIEW NOTES BY START -->
<div class="side-panel" id="view-notes-by">
<h2>View Notes By</h2>
<ul>
<li class="col1"><a href="/vuls/bypublished">Date Published</a></li>
<li><a href="/vuls/bypublic">Date Public</a></li>
<li class="col1"><a href="/vuls/byupdate">Date Updated</a></li>
<li><a href="/vuls/byCVSS">CVSS Score</a></li>
</ul>
<div class="spacer"></div>
<div class="more-content"></div>
</div>
<!-- VIEW NOTES BY END -->
<!-- REPORT A VULNERABILITY START -->
<div id="report-a-vul-widget">
<h2>Report a Vulnerability</h2>
<p><a href="https://vulcoord.cert.org/VulReport/"><img alt="Report a Vulnerability" src="/vuls/images/common/doc-feedback-icon.png"/></a>Please use the <a href="https://vulcoord.cert.org/VulReport/">Vulnerability Reporting Form</a> to report a vulnerability. Alternatively, you can send us <a href="mailto:cert@cert.org?subject=vulnerability%20report">email</a>. Be sure to read our <a href="http://www.cert.org/kb/vul_disclosure.html">vulnerability disclosure policy</a>.</p>
</div>
<!-- REPORT A VULNERABILITY END -->
<!-- CONNECT WITH US START -->
<div id="connect-with-us-widget">
<h2>Connect with Us</h2>
<ul>
<li class="feed"><a href="/vulfeed" title="Subscribe to our Vulnerability Notes feed">Subscribe to our feed</a></li>
<li class="blog"><a href="http://www.cert.org/blogs/certcc/" title="Read the CERT/CC blog">Read the CERT/CC blog</a></li>
</ul>
</div>
<!-- CONNECT WITH US END -->
</div>
</div>
<!-- MAIN BODY END -->
<!-- FOOTER START -->
<div id="footer-wrapper">
<div id="footer">
<div id="i-want-to">
<h3>I Want To</h3>
<ul>
<li><a href="https://vulcoord.cert.org/VulReport/">Report a vulnerability</a></li>
<li><a href="https://vulcoord.cert.org/VulReport/statement">Provide a vendor statement</a></li>
<li><a href="https://www.us-cert.gov/forms/report">Report an incident</a></li>
<li><a href="http://www.ic3.gov/complaint/">Report an internet crime</a></li>
</ul>
</div>
<div id="subscribe-to-alerts"><h3>Subscribe to Updates</h3>
<p>Receive security alerts, tips, and other updates.</p>
<form action="https://public.govdelivery.com/accounts/USDHSUSCERT/subscribers/qualify">
<input class="email-address-field long" id="email-address-field" name="email" title="Enter your email address" type="text" value="Enter your email address"/>
<input class="button blue-button" name="submit" type="submit" value="Sign Up"/>
</form>
</div>
<div id="contact-us">
<h3>Contact Us</h3>
<ul>
<li class="phone">+1 412-268-5800</li>
<li class="email"><a href="mailto:cert@cert.org" title="General questions or suggestions">Send us email</a></li>
<li class="keys"><a href="https://www.cert.org/contact_cert/encryptmail.html">Download PGP/GPG key</a></li>
</ul>
</div>
</div>
</div>
<!-- FOOTER END -->
<!-- SUB-FOOTER START -->
<div id="sub-footer">
<div class="copyright">
<p>Copyright © 1999-2018 Carnegie Mellon University</p>
</div>
<ul>
<li><a href="http://www.cert.org/legal_stuff/">Legal</a></li>
<li><a href="http://www.cert.org/contents/">Site Index</a></li>
<li><a href="http://www.cert.org/contact_cert/">Careers</a></li>
<li class="last"><a href="http://www.cert.org/nav/our_feeds.html">RSS Feeds</a></li>
</ul>
</div>
<script type="text/javascript">
		 $('#email-address-field').resetField();
	 </script>
<!-- SUB-FOOTER END -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-12114994-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></body>
</html>
