<!DOCTYPE html>

<html class="no-js" dir="ltr" lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<title>ROCA: Vulnerable RSA generation (CVE-2017-15361) [CRoCS wiki]</title>
<script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="/_media/wiki/favicon.ico" rel="shortcut icon"/>
<link href="/lib/tpl/bootstrap3/images/apple-touch-icon.png" rel="apple-touch-icon"/>
<meta content="DokuWiki" name="generator"/>
<meta content="index,follow" name="robots"/>
<meta content="public,papers,rsa_ccs17" name="keywords"/>
<link href="/lib/tpl/bootstrap3/assets/bootstrap/lumen/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/lib/tpl/bootstrap3/assets/fonts/lumen.fonts.css" rel="stylesheet" type="text/css"/>
<link href="/lib/exe/opensearch.php" rel="search" title="CRoCS wiki" type="application/opensearchdescription+xml"/>
<link href="/" rel="start"/>
<link href="/public/papers/rsa_ccs17?do=index" rel="contents" title="Sitemap"/>
<link href="https://crocs.fi.muni.cz/public/papers/rsa_ccs17" rel="canonical"/>
<link href="/lib/exe/css.php?t=bootstrap3&amp;tseed=9114349c34f15e7a7d486dd15c0ab14c" rel="stylesheet" type="text/css"/>
<link href="/lib/plugins/datatables/assets/datatables/media/css/dataTables.bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/lib/plugins/datatables/assets/datatables/extensions/FixedHeader/css/fixedHeader.bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/lib/plugins/datatables/assets/datatables/extensions/FixedColumns/css/fixedColumns.bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/lib/plugins/datatables/assets/datatables/extensions/Buttons/css/buttons.bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/lib/plugins/datatables/assets/datatables/extensions/Responsive/css/responsive.bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="//maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="//cdn.rawgit.com/stephenhutchings/typicons.font/master/src/font/typicons.min.css" rel="stylesheet" type="text/css"/>
<link href="//cdn.rawgit.com/Lukas-W/font-linux/v0.9/assets/font-linux.css" rel="stylesheet" type="text/css"/>
<link href="/lib/tpl/bootstrap3/assets/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<!--[if gte IE 9]><!-->
<script type="text/javascript">/*<![CDATA[*/var NS='public:papers';var JSINFO = {"id":"public:papers:rsa_ccs17","namespace":"public:papers","plugins":{"edittable":{"default columnwidth":""}},"fastwiki":{"secedit":1,"preview":1,"fastpages":1,"save":1,"fastshow":0,"fastshow_same_ns":1,"fastshow_include":"","fastshow_exclude":"","preload":false,"preload_head":"====47hsjwycv782nwncv8b920m8bv72jmdm3929bno3b3====","preload_batchsize":false,"preload_per_page":false,"locktime":840,"usedraft":1,"text_btn_show":"Show page","templatename":"bootstrap3"},"plugin":{"datatables":{"config":{"language":{"sEmptyTable":"No data available in table","sInfo":"Showing _START_ to _END_ of _TOTAL_ entries","sInfoEmpty":"Showing 0 to 0 of 0 entries","sInfoFiltered":"(filtered from _MAX_ total entries)","sInfoPostFix":"","sInfoThousands":",","sLengthMenu":"Show _MENU_ entries","sLoadingRecords":"Loading...","sProcessing":"Processing...","sSearch":"Search:","sZeroRecords":"No matching records found","oPaginate":{"sFirst":"First","sLast":"Last","sNext":"Next","sPrevious":"Previous"},"oAria":{"sSortAscending":": activate to sort column ascending","sSortDescending":": activate to sort column descending"}}},"enableForAllTables":1}},"move_renameokay":false,"plugin_folded":{"hide":"hide","reveal":"reveal"},"bootstrap3":{"mode":"show","config":{"collapsibleSections":0,"sidebarOnNavbar":0,"tagsOnTop":0,"tocAffix":1,"tocCollapseOnScroll":1,"tocCollapsed":0,"showSemanticPopup":0}}};
/*!]]>*/</script>
<script charset="utf-8" src="/lib/exe/jquery.php?tseed=23f888679b4f1dc26eef34902aca964f" type="text/javascript"></script>
<script charset="utf-8" src="/lib/exe/js.php?t=bootstrap3&amp;tseed=9114349c34f15e7a7d486dd15c0ab14c" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/media/js/jquery.dataTables.min.js" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/extensions/FixedHeader/js/dataTables.fixedHeader.min.js" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/extensions/FixedColumns/js/dataTables.fixedColumns.min.js" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/extensions/Buttons/js/dataTables.buttons.min.js" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/extensions/Buttons/js/buttons.html5.min.js" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/extensions/Buttons/js/buttons.print.min.js" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/extensions/Responsive/js/dataTables.responsive.min.js" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/media/js/dataTables.bootstrap.min.js" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/extensions/Buttons/js/buttons.bootstrap.min.js" type="text/javascript"></script>
<script src="/lib/plugins/datatables/assets/datatables/extensions/Responsive/js/responsive.bootstrap.min.js" type="text/javascript"></script>
<script type="text/javascript">/*<![CDATA[*/var emoji_assetsrc = "\/\/cdn.jsdelivr.net\/emojione\/";
/*!]]>*/</script>
<script src="/lib/tpl/bootstrap3/assets/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/lib/tpl/bootstrap3/assets/anchorjs/anchor.min.js" type="text/javascript"></script>
<script type="text/javascript">/*<![CDATA[*/jQuery(document).ready(function() { jQuery('body').scrollspy({ target: '#dw__toc', offset: 80 });jQuery("#dw__toc").affix({ offset: { top: (jQuery("main").position().top), bottom: (jQuery(document).height() - jQuery("main").height()) } });if (location.hash) { setTimeout(function() { scrollBy(0, -70); }, 1); }jQuery(document).trigger('bootstrap3:anchorjs'); });
/*!]]>*/</script>
<!--<![endif]-->
<style type="text/css">@media screen { body { padding-top: 70px; } #dw__toc.affix { top: 60px; position: fixed !important; }}</style>
<link href="/feed.php?ns=public:blog&amp;linkto=current&amp;content=html" rel="alternative" title="CRoCS: Privacy and security blog" type="application/rss+xml"/>
<!-- Google Analytics -->
<script type="text/javascript">
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga("create", "UA-69609349-1", "auto");
ga("send", "pageview");
ga("set", "anonymizeIp", true);
ga("send", "event", "DokuWiki", JSINFO.bootstrap3.mode);
</script>
<script async="" src="//www.google-analytics.com/analytics.js" type="text/javascript"></script>
<!-- End Google Analytics -->
<!--[if lt IE 9]>
  <script type="text/javascript" src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script type="text/javascript" src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="lumen dokuwiki mode_show tpl_bootstrap3" data-page-id="public:papers:rsa_ccs17">
<header class="dokuwiki container" id="dokuwiki__header">
<nav class="navbar navbar-fixed-top navbar-inverse" role="navigation">
<div class="container">
<div class="navbar-header">
<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a accesskey="h" class="navbar-brand" href="/main" title="[H]"><img alt="CRoCS wiki" class="pull-left dw-logo-tagline" height="32" id="dw__logo" src="/_media/wiki/logo.png" style="margin-top:-5px"/> <span id="dw__title" style="margin-top:-5px">CRoCS wiki<span id="dw__tagline">Centre for Research on Cryptography and Security</span></span></a>
</div>
<div class="collapse navbar-collapse">
<div class="navbar-right">
<form accept-charset="utf-8" action="/main" class="navbar-form navbar-left search" id="dw__search" method="get" role="search"><div class="no"><div class="form-group"><input name="do" type="hidden" value="search"/><input accesskey="f" class="edit form-control" id="qsearch__in" name="id" placeholder="Search" title="[F]" type="search"/></div> <button class="btn btn-default" title="Search" type="submit"><i class="fa fa-fw fa-search"></i><span class="hidden-lg hidden-md hidden-sm"> Search</span></button><div class="panel panel-default ajax_qsearch JSpopup" id="qsearch__out"></div></div></form>
<ul class="nav navbar-nav dw-action-icon" id="dw__tools">
<li class="dropdown">
<a aria-expanded="false" aria-haspopup="true" class="dropdown-toggle" data-target="#" data-toggle="dropdown" href="" role="button" title="Site Tools">
<i class="fa fa-fw fa-cubes"></i> <span class="hidden-lg hidden-md hidden-sm">Site Tools</span> <span class="caret"></span>
</a>
<ul class="dropdown-menu tools" role="menu">
<li class="dropdown-header hidden-xs hidden-sm">
<i class="fa fa-fw fa-cubes"></i> Site Tools      </li>
<li><a accesskey="r" class="action recent" href="/public/papers/rsa_ccs17?do=recent" rel="nofollow" title="Recent Changes [R]">Recent Changes</a></li><li><a class="action media" href="/public/papers/rsa_ccs17?do=media&amp;ns=public%3Apapers" rel="nofollow" title="Media Manager">Media Manager</a></li><li><a accesskey="x" class="action index" href="/public/papers/rsa_ccs17?do=index" rel="nofollow" title="Sitemap [X]">Sitemap</a></li>
</ul>
</li>
<li class="dropdown">
<a aria-expanded="false" aria-haspopup="true" class="dropdown-toggle" data-target="#" data-toggle="dropdown" href="" role="button" title="Page Tools">
<i class="fa fa-fw fa-file"></i> <span class="hidden-lg hidden-md hidden-sm">Page Tools</span> <span class="caret"></span>
</a>
<ul class="dropdown-menu tools" role="menu">
<li class="dropdown-header hidden-xs hidden-sm">
<i class="fa fa-fw fa-file"></i> Page Tools      </li>
<li><a accesskey="v" class="action source" href="/public/papers/rsa_ccs17?do=edit" rel="nofollow" title="Show pagesource [V]">Show pagesource</a></li><li><a accesskey="o" class="action revs" href="/public/papers/rsa_ccs17?do=revisions" rel="nofollow" title="Old revisions [O]">Old revisions</a></li><li><a class="action backlink" href="/public/papers/rsa_ccs17?do=backlink" rel="nofollow" title="Backlinks">Backlinks</a></li><li class="plugin_move_page"><a href="javascript:void(0)" title="Rename Page"><i class="fa fa-fw fa-i-cursor text-muted"></i> Rename Page</a></li></ul></li></ul></div></div></div></nav></header></body></html><li><a class="fold_unfold_all" href="javascript:void(0);" onclick="fold_unfold_all();" rel="nofollow" title="Fold/unfold all"><i class="fa fa-fw fa-puzzle-piece"></i> Fold/unfold all</a></li><li><a accesskey="t" class="action top" href="#dokuwiki__top" rel="nofollow" title="Back to top [T]">Back to top</a></li>



<ul class="nav navbar-nav">
<li>
<span class="dw__actions dw-action-icon">
<a class="action btn btn-default navbar-btn login" href="/public/papers/rsa_ccs17?do=login&amp;sectok=" rel="nofollow" title="Log In"><span class="sr-only">Log In</span></a> </span>
</li>
</ul>





<div class="dokuwiki container" id="dokuwiki__top">
<div id="dokuwiki__pageheader">
<div class="small" id="dw__breadcrumbs">
<hr/>
<div class="dw__youarehere">
<ol class="breadcrumb"><li>You are here</li><li><a href="/main" title="main"><i class="fa fa-fw fa-home"></i></a></li><li><a class="wikilink1" href="/public/main" title="public:main">Public</a></li><li><a class="wikilink1" href="/public/papers/main" title="public:papers:main">Supplementary materials for journal and conference papers</a></li><li class="active"><span><a class="wikilink1" href="/public/papers/rsa_ccs17" title="public:papers:rsa_ccs17">ROCA: Vulnerable RSA generation (CVE-2017-15361)</a></span></li></ol> </div>
<hr/>
</div>
<p class="pageId text-right small">
</p>
<div class="small" id="dw__msgarea">
</div>
</div>
<main class="main row" role="main">
<!-- ********** ASIDE ********** -->
<aside class="dw__sidebar col-sm-3 col-md-2 hidden-print small" id="dokuwiki__aside">
<div class="dw-sidebar-content">
<div class="dw-sidebar-title hidden-lg hidden-md hidden-sm" data-target="#dokuwiki__aside .dw-sidebar-body" data-toggle="collapse">
<i class="fa fa-fw fa-th-list"></i> Sidebar    </div>
<div class="dw-sidebar-body collapse in">
<h3 class="sectionedit1 page-header" id="quick_links">Quick links</h3>
<div class="level3">
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-globe" data-btn-type="info"><a class="wikilink1" href="/main" title="main">Homepage</a></span>
</p>
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-twitter" data-btn-type="default"><a class="urlextern" href="https://twitter.com/crocs_muni" rel="nofollow noopener" target="_blank" title="https://twitter.com/crocs_muni">Lab Twitter</a></span>
</p>
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-lightbulb-o" data-btn-type="warning"><a class="wikilink1" href="/public/research/main" title="public:research:main">Research topics</a></span>
</p>
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-file-text-o" data-btn-type="default"><a class="wikilink1" href="/publications/main" title="publications:main">Publications</a></span>
</p>
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-briefcase" data-btn-type="default"><a class="wikilink1" href="/public/hire" title="public:hire">Open positions</a></span>
</p>
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-gamepad" data-btn-type="success"><a class="wikilink1" href="/public/openlab/main" title="public:openlab:main">CRoCS OpenLab</a></span>
</p>
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-file-text-o" data-btn-type="default"><a class="urlextern" href="http://www.fi.muni.cz/research/crocs/theses.xhtml.en" rel="nofollow noopener" target="_blank" title="http://www.fi.muni.cz/research/crocs/theses.xhtml.en">Bc &amp; Mgr theses</a></span>
</p>
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-wikipedia-w" data-btn-type="primary"><a class="wikilink1" href="/internal/crocs/main" title="internal:crocs:main"> Internal wiki</a></span>
</p>
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-database" data-btn-type="default"><a class="wikilink1" href="/storage" title="storage"> Storage server</a></span>
</p>
<p>
<span class="bs-wrap bs-wrap-button" data-btn-block="1" data-btn-icon="fa fa-photo" data-btn-type="default"><a class="wikilink1" href="/photogallery" title="photogallery"> Photogallery</a></span>
</p>
</div>
</div>
</div>
</aside>
<!-- ********** CONTENT ********** -->
<article class="col-sm-9 col-md-10 " id="dokuwiki__content">
<div class="no-panel">
<div class="page ">
<div class="dw-content "><div class="plugin_fastwiki_marker" style="display:none"></div>
<h1 class="sectionedit1 page-header" id="rocavulnerable_rsa_generation_cve-2017-15361">ROCA: Vulnerable RSA generation (CVE-2017-15361)</h1>
<div class="level1">
<p>
<strong>&lt;TLDR&gt;</strong>
</p>
<p>
A newly discovered vulnerability in generation of RSA keys used by a software library adopted in cryptographic smartcards, security tokens and other secure hardware chips manufactured by Infineon Technologies AG allows for a practical factorization attack, in which the attacker computes the private part of an RSA key. The attack is feasible for commonly used key lengths, including 1024 and 2048 bits, and affects chips manufactured as early as 2012, that are now commonplace. Assess your keys now with the provided <a class="urlextern" href="https://crocs.fi.muni.cz/public/papers/rsa_ccs17#detection_tools_mitigation_and_workarounds" rel="nofollow noopener" target="_blank" title="https://crocs.fi.muni.cz/public/papers/rsa_ccs17#detection_tools_mitigation_and_workarounds"> offline and online detection tools</a> and contact your vendor if you are affected. Major vendors including Microsoft, Google, HP, Lenovo, Fujitsu already released the software updates and guidelines for a mitigation. Full details including the factorization method will be released in 2 weeks at the <a class="urlextern" href="https://www.sigsac.org/ccs/CCS2017/" rel="nofollow noopener" target="_blank" title="https://www.sigsac.org/ccs/CCS2017/"> ACM CCS conference</a> as 'The Return of Coppersmith's Attack: Practical Factorization of Widely Used RSA Moduli' (ROCA) research paper. 
</p>
<p>
Download full paper: <a class="media mediafile mf_pdf" href="/_media/public/papers/nemec_roca_ccs17_preprint.pdf" rel="noopener" target="_blank" title="public:papers:nemec_roca_ccs17_preprint.pdf (2.6 MB)"> pdf</a>
</p>
<p>
<strong>&lt;/TLDR&gt;</strong>
</p>
</div>
<h2 class="sectionedit2 page-header" id="description_of_the_vulnerability">Description of the vulnerability</h2>
<div class="level2">
<p>
A security vulnerability was found in the implementation of RSA keypair generation in a cryptographic library used in a wide range of cryptographic chips produced by Infineon Technologies AG. The product is also integrated in authentication, signature and encryption tokens of other vendors and chips used for Trusted Boot of operating systems. The vulnerability is present in NIST FIPS 140-2 and CC EAL 5+ certified devices since at least the year 2012.
<a class="media" href="/_detail/public/papers/roca_impact.png?id=public%3Apapers%3Arsa_ccs17" rel="noopener" target="_blank" title="public:papers:roca_impact.png"><img alt="" class="mediaright img-responsive" src="/_media/public/papers/roca_impact.png?w=400&amp;tok=973b60" width="400"/></a>
</p>
<p>
The algorithmic vulnerability is characterized by a specific structure of the generated RSA primes, which makes factorization of commonly used key lengths including 1024 and 2048 bits practically possible. Only the knowledge of a public key is necessary and no physical access to the vulnerable device is required. The vulnerability does NOT depend on a weak or a faulty random number generator - all RSA keys generated by a vulnerable chip are impacted. The attack was practically verified for several randomly selected 1024-bit RSA keys and for several selected 2048-bit keys.  
</p>
<p>
The specific structure of the primes in question allows for a fast detection of vulnerable keys, even in very large datasets. This property is useful for mitigation (users can assess own keys for vulnerability), but also for potential attackers (keys vulnerable to factorization can be pre-selected, without undergoing time-consuming factorization attempts).
The worst cases for the factorization of 1024 and 2048-bit keys are less than 3 CPU-months and 100 CPU-years, respectively, on a single core of a common recent CPU, while the expected time is half of that of the worst case. The factorization can be easily parallelized on multiple CPUs. Where <em>k</em> CPUs are available, the wall time required for the attack will be reduced <em>k-times</em> - allowing for practical factorization in order of hours or days. The worst-case price of the factorization on an Amazon AWS c4 computation instance is $76 for the 1024-bit key and about $40,000 for the 2048-bit key. 
</p>
<p>
The difficulty of the factorization attack is not the same for all key lengths and is NOT strictly increasing (some longer keys may take less time to factorize than other shorter ones). The following key length ranges are now considered practically factorizable (time complexity between hours to 1000 CPU years at maximum): 512 to 704 bits, 992 to 1216 bits and 1984 to 2144 bits. Note that 4096-bit RSA key is not practically factorizable now, but may become so, if the attack is improved.  
</p>
<p>
The time complexity and cost for the selected key lengths (Intel E5-2650 v3@3GHz Q2/2014):
</p>
<ul>
<li class="level1"><div class="li"> 512 bit RSA keys - 2 CPU hours (the cost of $0.06);</div>
</li>
<li class="level1"><div class="li"> 1024 bit RSA keys – 97 CPU days (the cost of $40-$80);  </div>
</li>
<li class="level1"><div class="li"> 2048 bit RSA keys – 140.8 CPU years, (the cost of $20,000 - $40,000).</div>
</li>
</ul>
<p>
The vulnerability was found by a close inspection of a large number of RSA keys generated and exported from the manufacturer smartcards by researchers at CRoCS laboratory, Masaryk University, Enigma Bridge and Ca' Foscari University. The full results will be presented at an academic ACM Conference on Computer and Communications Security (ACM CCS '17) starting from October 30th. 
</p>
<p>
The vulnerability was disclosed to Infineon Technologies AG, following the responsible disclosure principle, in the first week of February with agreement of an 8 month period before a public disclosure. We cooperated with the manufacturer and other affected parties to help evaluate and mitigate this vulnerability during this period. Major vendors including Microsoft, Google, HP, Lenovo, Fujitsu already released the software updates and guidelines for a mitigation. We are now notifying general public and releasing tools for assessmnet of the individual keys. 
</p>
</div>
<h2 class="sectionedit3 page-header" id="impact">Impact</h2>
<div class="level2">
<p>
A remote attacker can compute an RSA private key from the value of a public key. The private key can be misused for impersonation of a legitimate owner, decryption of sensitive messages, forgery of signatures (such as for software releases) and other related attacks.   
</p>
<p>
The actual impact of the vulnerability depends on the usage scenario, availability of the public keys and the lengths of keys used. We found and analyzed vulnerable keys in various domains including electronic citizen documents, authentication tokens, trusted boot devices, software package signing, TLS/HTTPS keys and PGP. The currently confirmed number of vulnerable keys found is about 760,000 but possibly up to two to three magnitudes more are vulnerable. The details will be presented in two weeks at the ACM CCS conference.
</p>
<p>
The vulnerable chips are pervasive and not necessarily sold directly by Infineon Technologies AG, as the chips can be embedded inside devices of other manufacturers. 
</p>
</div>
<h2 class="sectionedit4 page-header" id="detection_tools_mitigation_and_workarounds">Detection tools, mitigation and workarounds</h2>
<div class="level2">
<p>
The first step is to detect if you use a chip with the vulnerable library. As the vulnerability is present in the on-chip software library and not limited just to a particular batch of hardware, the only reliable way is to generate an RSA keypair on the device and test the public key by the provided tools (see below). It is recommended to test also the keys already in use. We believe the tools are very accurate - it is highly unlikely that a secure key would be flagged, as well as that a vulnerable key would be missed. 
</p>
<p>
We provide the following tools:
</p>
<ul>
<li class="level1"><div class="li"> <strong>Offline testers</strong>: Python/Java/C++ applications and tutorials (<a class="urlextern" href="https://github.com/crocs-muni/roca" rel="nofollow noopener" target="_blank" title="https://github.com/crocs-muni/roca">https://github.com/crocs-muni/roca</a>). We release all offline tools under the MIT license so it can be embedded into other testing applications and services. </div>
</li>
<li class="level1"><div class="li"> <strong>Online testers</strong>: Upload public key to <a class="urlextern" href="https://keychest.net/roca" rel="nofollow noopener" target="_blank" title="https://keychest.net/roca">https://keychest.net/roca</a> or <a class="urlextern" href="https://keytester.cryptosense.com" rel="nofollow noopener" target="_blank" title="https://keytester.cryptosense.com">https://keytester.cryptosense.com</a> to test your key.</div>
</li>
<li class="level1"><div class="li"> <strong>Email S-MIME/PGP tester</strong>: Send a signed email to <a class="mail" href="mailto:roca@keychest.net" title="roca@keychest.net">roca@keychest.net</a> to obtain an automatic email response with the analysis of the signing key vulnerability.  </div>
</li>
</ul>
<p>
If a vulnerable key is found, then you should contact your device vendor for further advice.
</p>
<p>
The following general advices may apply:
</p>
<ul>
<li class="level1"><div class="li"> Apply the software update if available.</div>
</li>
<li class="level1"><div class="li"> Replace the device with one without the vulnerable library.</div>
</li>
<li class="level1"><div class="li"> Generate a secure RSA keypair outside the device (e.g., via the OpenSSL library) and import it to the device. We are not aware of any vulnerability in connection with the actual use of the key, only the generation phase has a confirmed vulnerability.</div>
</li>
<li class="level1"><div class="li"> Use other cryptographic algorithm (e.g., ECC) instead of RSA on affected devices.</div>
</li>
<li class="level1"><div class="li"> Apply additional risk management within your environment, if the RSA key in use is detected as vulnerable.</div>
</li>
<li class="level1"><div class="li"> Use key lengths which are not currently impacted (e.g., 3936 bits) by our factorization method. Be aware: use this specific mitigation only as a last resort, as the attack may be improved. </div>
</li>
</ul>
</div>
<h2 class="sectionedit5 page-header" id="team">Team</h2>
<div class="level2">
<p>
The vulnerability was discovered by Slovak and Czech security researchers from the Centre for Research on Cryptography and Security at Masaryk University, Czech Republic; Enigma Bridge Ltd, Cambridge, UK; and Ca' Foscari University of Venice, Italy.
</p>
</div>
<h2 class="sectionedit6 page-header" id="updates">Updates</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> 2nd of November - Presentation of ROCA at the ACM CCS conference, received Real-World Impact Award </div>
</li>
<li class="level1"><div class="li"> 30th October 2017 - Full paper made public: <a class="urlextern" href="https://acmccs.github.io/papers/p1631-nemecA.pdf" rel="nofollow noopener" target="_blank" title="https://acmccs.github.io/papers/p1631-nemecA.pdf"> pdf</a></div>
</li>
<li class="level1"><div class="li"> 16th of October 2017 - The initial version of the public disclosure published, detector of vulnerable keys <a class="urlextern" href="https://github.com/crocs-muni/roca" rel="nofollow noopener" target="_blank" title="https://github.com/crocs-muni/roca"> published</a> </div>
</li>
<li class="level1"><div class="li"> May to October 2017 - Cooperation with the manufacturer and other affected parties to help evaluate and mitigate the vulnerability</div>
</li>
<li class="level1"><div class="li"> 1st of February - The vulnerability disclosed to Infineon Technologies AG</div>
</li>
<li class="level1"><div class="li"> End of January - The vulnerability found </div>
</li>
</ul>
</div>
<h2 class="sectionedit7 page-header" id="q_a">Q&amp;A</h2>
<div class="level2">
<p>
<strong>Q:</strong> Is the RSA algorithm insecure in general after the disclosure of this vulnerability?<br/>
<strong>A:</strong> No. If the RSA primes are generated as a truly random numbers, our method cannot be applied. For example, keys generated by the OpenSSL library are NOT affected.
</p>
<p>
<strong>Q:</strong> How can I be sure that my keys are not affected?<br/>
<strong>A:</strong> Run one of the <a class="urlextern" href="https://crocs.fi.muni.cz/public/papers/rsa_ccs17#detection_tools_mitigation_and_workarounds" rel="nofollow noopener" target="_blank" title="https://crocs.fi.muni.cz/public/papers/rsa_ccs17#detection_tools_mitigation_and_workarounds"> provided detection tools</a>. We believe that the tool has practically no false positives (if a key is flagged as vulnerable, it is vulnerable) and no false negatives (if a key is not detected as vulnerable, it is safe against our attack).
</p>
<p>
<strong>Q:</strong> How can I mitigate the vulnerability?<br/>
<strong>A:</strong> Contact your vendor and ask for help, apply the patch if available. 
</p>
<p>
<strong>Q:</strong> There was a recent (10th of October) security advisory regarding Trusted Platform Modules (TPM) by Microsoft, Google and other vendors. Is this connected to the vulnerability announced in this disclosure?<br/>

A: Yes, this is the direct result of the vulnerability found as the affected devices are using TPMs with the vulnerable library.
</p>
<p>
<strong>Q:</strong> Are ECC keys generated on the affected chips vulnerable?<br/>
<strong>A:</strong> No. We found no vulnerability in the ECC key generation of the vulnerable library. 
</p>
<p>
<strong>Q:</strong> The Coppershmith's attack was already used to factorize keys from cryptographic smartcards. Is this an instance of the same vulnerability?<br/>
<strong>A:</strong> No, this one is different. Daniel J. Bernstein, Yun-An Chang, Chen-Mou Cheng, Li-Ping Chou, Nadia Heninger, Tanja Lange and Nicko van Someren in 2013 devised a method to exploit flawed random number generator in Taiwanese citizen cards, present due to a manufacturing defect in some of the cards <a class="urlextern" href="https://smartfacts.cr.yp.to/smartfacts-20130916.pdf" rel="nofollow noopener" target="_blank" title="https://smartfacts.cr.yp.to/smartfacts-20130916.pdf">https://smartfacts.cr.yp.to/smartfacts-20130916.pdf</a>. This new vulnerability applies to all chips equipped with the vulnerable library.
</p>
<p>
<strong>Q:</strong> How was the vulnerability found?<br/>
<strong>A:</strong> We analyzed the statistical properties of a large number of RSA keys generated and extracted from various smartcards during the previous research work published at USENIX Security 2016 conference (<a class="urlextern" href="https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/svenda" rel="nofollow noopener" target="_blank" title="https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/svenda">https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/svenda</a>). No reverse engineering of the chip or the library was performed.
</p>
<p>
<strong>Q:</strong> Are FIDO U2F authentication tokens affected?<br/>
<strong>A:</strong> No. The U2F specifications only allow for ECC-based authentication.
</p>
</div>
<h2 class="sectionedit8 page-header" id="technical_references">Technical references</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Infineon, Information on software update of RSA key generation function: <a class="urlextern" href="https://www.infineon.com/RSA-update" rel="nofollow noopener" target="_blank" title="https://www.infineon.com/RSA-update">https://www.infineon.com/RSA-update</a></div>
</li>
<li class="level1"><div class="li"> Infineon, Information on TPM firmware update for Microsoft Windows systems <a class="urlextern" href="https://www.infineon.com/cms/en/product/promopages/tpm-update/?redirId=59160" rel="nofollow noopener" target="_blank" title="https://www.infineon.com/cms/en/product/promopages/tpm-update/?redirId=59160">https://www.infineon.com/cms/en/product/promopages/tpm-update/?redirId=59160</a></div>
</li>
<li class="level1"><div class="li"> Microsoft Vulnerability in TPM could allow Security Feature Bypass: <a class="urlextern" href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170012" rel="nofollow noopener" target="_blank" title="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170012">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170012</a></div>
</li>
<li class="level1"><div class="li"> Google, The Chromium project Trusted Platform Module firmware vulnerability: <a class="urlextern" href="https://sites.google.com/a/chromium.org/dev/chromium-os/tpm_firmware_update" rel="nofollow noopener" target="_blank" title="https://sites.google.com/a/chromium.org/dev/chromium-os/tpm_firmware_update">https://sites.google.com/a/chromium.org/dev/chromium-os/tpm_firmware_update</a></div>
</li>
<li class="level1"><div class="li"> CVE-2017-15361: <a class="urlextern" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15361" rel="nofollow noopener" target="_blank" title="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15361">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15361</a>, <a class="urlextern" href="https://nvd.nist.gov/vuln/detail/CVE-2017-15361" rel="nofollow noopener" target="_blank" title="https://nvd.nist.gov/vuln/detail/CVE-2017-15361">https://nvd.nist.gov/vuln/detail/CVE-2017-15361</a></div>
</li>
<li class="level1"><div class="li"> National Cyber Security Centre, UK: <a class="urlextern" href="https://www.ncsc.gov.uk/guidance/roca-infineon-tpm-and-secure-element-rsa-vulnerability-guidance" rel="nofollow noopener" target="_blank" title="https://www.ncsc.gov.uk/guidance/roca-infineon-tpm-and-secure-element-rsa-vulnerability-guidance">https://www.ncsc.gov.uk/guidance/roca-infineon-tpm-and-secure-element-rsa-vulnerability-guidance</a></div>
</li>
<li class="level1"><div class="li"> D.J.Bernstein and T. Lange, Reconstructing ROCA: <a class="urlextern" href="https://blog.cr.yp.to/20171105-infineon.html" rel="nofollow noopener" target="_blank" title="https://blog.cr.yp.to/20171105-infineon.html">https://blog.cr.yp.to/20171105-infineon.html</a></div>
</li>
</ul>
</div>
<h2 class="sectionedit9 page-header" id="media">Media</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> ArsTechnica: <a class="urlextern" href="https://arstechnica.com/information-technology/2017/10/crypto-failure-cripples-millions-of-high-security-keys-750k-estonian-ids/" rel="nofollow noopener" target="_blank" title="https://arstechnica.com/information-technology/2017/10/crypto-failure-cripples-millions-of-high-security-keys-750k-estonian-ids/">https://arstechnica.com/information-technology/2017/10/crypto-failure-cripples-millions-of-high-security-keys-750k-estonian-ids/</a></div>
</li>
<li class="level1"><div class="li"> Forbes: <a class="urlextern" href="https://www.forbes.com/sites/thomasbrewster/2017/10/16/worse-than-krack-google-and-microsoft-patch-massive-5-year-old-encryption-hole/#40c81a9447c3" rel="nofollow noopener" target="_blank" title="https://www.forbes.com/sites/thomasbrewster/2017/10/16/worse-than-krack-google-and-microsoft-patch-massive-5-year-old-encryption-hole/#40c81a9447c3">https://www.forbes.com/sites/thomasbrewster/2017/10/16/worse-than-krack-google-and-microsoft-patch-massive-5-year-old-encryption-hole/#40c81a9447c3</a></div>
</li>
<li class="level1"><div class="li"> Estonian ID cards: <a class="urlextern" href="http://news.err.ee/616732/potential-security-risk-could-affect-750-000-estonian-id-cards" rel="nofollow noopener" target="_blank" title="http://news.err.ee/616732/potential-security-risk-could-affect-750-000-estonian-id-cards">http://news.err.ee/616732/potential-security-risk-could-affect-750-000-estonian-id-cards</a></div>
</li>
<li class="level1"><div class="li"> The Register: <a class="urlextern" href="https://www.theregister.co.uk/2017/10/16/roca_crypto_vuln_infineon_chips/" rel="nofollow noopener" target="_blank" title="https://www.theregister.co.uk/2017/10/16/roca_crypto_vuln_infineon_chips/">https://www.theregister.co.uk/2017/10/16/roca_crypto_vuln_infineon_chips/</a></div>
</li>
<li class="level1"><div class="li"> The Hacker News: <a class="urlextern" href="https://thehackernews.com/2017/10/rsa-encryption-keys.html" rel="nofollow noopener" target="_blank" title="https://thehackernews.com/2017/10/rsa-encryption-keys.html">https://thehackernews.com/2017/10/rsa-encryption-keys.html</a></div>
</li>
<li class="level1"><div class="li"> Reuters: <a class="urlextern" href="https://www.reuters.com/article/us-infineon-cyber/infineon-says-has-fixed-encryption-flaw-found-by-researchers-idUSKBN1CL2KC" rel="nofollow noopener" target="_blank" title="https://www.reuters.com/article/us-infineon-cyber/infineon-says-has-fixed-encryption-flaw-found-by-researchers-idUSKBN1CL2KC">https://www.reuters.com/article/us-infineon-cyber/infineon-says-has-fixed-encryption-flaw-found-by-researchers-idUSKBN1CL2KC</a></div>
</li>
<li class="level1"><div class="li"> ZDNet: <a class="urlextern" href="http://www.zdnet.com/article/as-devastating-as-krack-new-vulnerability-undermines-rsa-encryption-keys/" rel="nofollow noopener" target="_blank" title="http://www.zdnet.com/article/as-devastating-as-krack-new-vulnerability-undermines-rsa-encryption-keys/">http://www.zdnet.com/article/as-devastating-as-krack-new-vulnerability-undermines-rsa-encryption-keys/</a></div>
</li>
<li class="level1"><div class="li"> engadget: <a class="urlextern" href="https://www.engadget.com/2017/10/16/encryption-companies-rely-on-has-serious-flaw/" rel="nofollow noopener" target="_blank" title="https://www.engadget.com/2017/10/16/encryption-companies-rely-on-has-serious-flaw/">https://www.engadget.com/2017/10/16/encryption-companies-rely-on-has-serious-flaw/</a></div>
</li>
<li class="level1"><div class="li"> The Register: <a class="urlextern" href="https://www.theregister.co.uk/2017/10/23/roca_crypto_flaw_gemalto/" rel="nofollow noopener" target="_blank" title="https://www.theregister.co.uk/2017/10/23/roca_crypto_flaw_gemalto/">https://www.theregister.co.uk/2017/10/23/roca_crypto_flaw_gemalto/</a></div>
</li>
<li class="level1"><div class="li"> ArsTechnica: <a class="urlextern" href="https://arstechnica.com/information-technology/2017/10/crippling-crypto-weakness-opens-millions-of-smartcards-to-cloning/" rel="nofollow noopener" target="_blank" title="https://arstechnica.com/information-technology/2017/10/crippling-crypto-weakness-opens-millions-of-smartcards-to-cloning/">https://arstechnica.com/information-technology/2017/10/crippling-crypto-weakness-opens-millions-of-smartcards-to-cloning/</a></div>
</li>
<li class="level1"><div class="li"> RSA Security: <a class="urlextern" href="https://www.rsa.com/en-us/blog/2017-10/roca-blaming-infineon-is-the-easy-way-out" rel="nofollow noopener" target="_blank" title="https://www.rsa.com/en-us/blog/2017-10/roca-blaming-infineon-is-the-easy-way-out">https://www.rsa.com/en-us/blog/2017-10/roca-blaming-infineon-is-the-easy-way-out</a></div>
</li>
<li class="level1"><div class="li"> ArsTechnica: <a class="urlextern" href="https://arstechnica.com/information-technology/2017/11/flaw-crippling-millions-of-crypto-keys-is-worse-than-first-disclosed/" rel="nofollow noopener" target="_blank" title="https://arstechnica.com/information-technology/2017/11/flaw-crippling-millions-of-crypto-keys-is-worse-than-first-disclosed/">https://arstechnica.com/information-technology/2017/11/flaw-crippling-millions-of-crypto-keys-is-worse-than-first-disclosed/</a></div>
</li>
<li class="level1"><div class="li"> SC Media: <a class="urlextern" href="https://www.scmagazineuk.com/roca-the-role-of-key-generation-and-decrypting-of-private-keys/article/704343/" rel="nofollow noopener" target="_blank" title="https://www.scmagazineuk.com/roca-the-role-of-key-generation-and-decrypting-of-private-keys/article/704343/">https://www.scmagazineuk.com/roca-the-role-of-key-generation-and-decrypting-of-private-keys/article/704343/</a></div>
</li>
<li class="level1"><div class="li"> Cybernetica: <a class="urlextern" href="https://cyber.ee/en/news/cybernetica-case-study-solving-the-estonian-id-card-case/" rel="nofollow noopener" target="_blank" title="https://cyber.ee/en/news/cybernetica-case-study-solving-the-estonian-id-card-case/">https://cyber.ee/en/news/cybernetica-case-study-solving-the-estonian-id-card-case/</a></div>
</li>
</ul>
</div>
<h1 class="sectionedit10 page-header" id="paper_details">Paper details</h1>
<div class="level1">
<p>
<strong>Paper title: The Return of Coppersmith's Attack: Practical Factorization of Widely Used RSA Moduli [ACM CCS 2017]</strong><br/>
<strong>Authors: Matus Nemec, Marek Sys, Petr Svenda, Dusan Klinec and Vashek Matyas</strong><br/>
<strong>Primary contact:</strong> Petr Svenda <a class="mail" href="mailto:svenda@fi.muni.cz" title="svenda@fi.muni.cz">svenda@fi.muni.cz</a>
</p>
<ul>
<li class="level1"><div class="li"> Conference page: <a class="urlextern" href="https://www.sigsac.org/ccs/CCS2017/" rel="nofollow noopener" target="_blank" title="https://www.sigsac.org/ccs/CCS2017/"> ACM CCS 2017</a></div>
</li>
<li class="level1"><div class="li"> Author ePrint version of the paper: <a class="media mediafile mf_pdf" href="/_media/public/papers/nemec_roca_ccs17_preprint.pdf" rel="noopener" target="_blank" title="public:papers:nemec_roca_ccs17_preprint.pdf (2.6 MB)"> pdf</a></div>
</li>
<li class="level1"><div class="li"> Conference slides: <a class="media mediafile mf_pdf" href="/_media/public/papers/ccs-nemec-handout.pdf" rel="noopener" target="_blank" title="public:papers:ccs-nemec-handout.pdf (2.1 MB)"> pdf</a></div>
</li>
</ul>
<p>
<strong>Bibtex (regular paper)</strong>
</p>
<pre class="code">@inproceedings{2017-ccs-nemec,
  Author        = {Matus Nemec and Marek Sys and Petr Svenda and Dusan Klinec and Vashek Matyas},
  Title         = {{The Return of Coppersmith's Attack: Practical Factorization of Widely Used RSA Moduli}},
  BookTitle     = {24th ACM Conference on Computer and Communications Security (CCS'2017)},
  Year          = {2017},
  ISBN          = {978-1-4503-4946-8/17/10},
  Publisher     = {ACM},
  Pages         = {1631-1648}
}</pre>
<hr/>
</div>
</div>
</div>
</div>
</article>
</main>
<div class="small text-right">
</div>
<img alt="" height="1" src="/lib/exe/indexer.php?id=public%3Apapers%3Arsa_ccs17&amp;1516513373" width="2"/>
<a accesskey="t" class="back-to-top hidden-print btn btn-default btn-sm" href="#dokuwiki__top" title="skip to content"><i class="fa fa-chevron-up"></i></a>
<div id="screen__mode"> <span class="visible-xs-block"></span>
<span class="visible-sm-block"></span>
<span class="visible-md-block"></span>
<span class="visible-lg-block"></span>
</div>
</div>


